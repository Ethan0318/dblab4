# ğŸ“˜ HuaDB â€“ ä¸€ä¸ªè½»é‡çº§æ•™å­¦ç”¨æ•°æ®åº“å†…æ ¸ï¼ˆè¯¾ç¨‹å®éªŒé¡¹ç›®ï¼‰

HuaDB æ˜¯ä¸€ä¸ªè½»é‡çº§ã€é¢å‘æ•™å­¦åœºæ™¯çš„æ•°æ®åº“å†…æ ¸æ¡†æ¶ã€‚
 å®ƒé‡‡ç”¨ C++17 ç¼–å†™ï¼Œè¦†ç›–äº†æ•°æ®åº“ç³»ç»Ÿä¸­ä»å­˜å‚¨ã€ç¼“å†²æ± ã€äº‹åŠ¡ã€æ—¥å¿—ã€å¹¶å‘æ§åˆ¶åˆ°æŸ¥è¯¢æ‰§è¡Œå’ŒæŸ¥è¯¢ä¼˜åŒ–çš„å®Œæ•´é“¾è·¯ï¼Œæ–¹ä¾¿å­¦ç”Ÿé€šè¿‡è¡¥å…¨å…³é”®æ¨¡å—æ¥ç†è§£æ•°æ®åº“çš„å†…éƒ¨åŸç†ã€‚

æœ¬ä»“åº“åŒ…å«è¯¾ç¨‹å®éªŒæ‰€éœ€çš„å…¨éƒ¨åŸºç¡€ä»£ç ã€æµ‹è¯•ç”¨ä¾‹ï¼Œä»¥åŠä½ æ ¹æ®å®éªŒè¦æ±‚è¡¥å……çš„å®ç°ä»£ç ã€‚

------

# ğŸ“š ç›®å½•

- é¡¹ç›®ç®€ä»‹
- æ•´ä½“æ¶æ„
- å®éªŒå†…å®¹ç®€ä»‹ï¼ˆLab0â€“Lab5ï¼‰
- ç¯å¢ƒè¦æ±‚ï¼ˆè¡¥å…… & æ‰©å±•ï¼‰
- é¡¹ç›®æ„å»º
- è¿è¡Œæ•°æ®åº“ Shell
- è¿è¡Œæµ‹è¯•ç”¨ä¾‹
- ä»£ç ç›®å½•ç»“æ„è¯´æ˜
- å¸¸è§é—®é¢˜ FAQ
- License

------

# ğŸ§­ é¡¹ç›®ç®€ä»‹

HuaDB çš„æ ¸å¿ƒç›®æ ‡æ˜¯é€šè¿‡â€œè¡¥å…¨æ•°æ®åº“å†…æ ¸â€çš„æ–¹å¼ï¼Œè®©å­¦ç”Ÿåœ¨å®éªŒä¸­äº²æ‰‹å®ç°ï¼š

- é¡µå¼å­˜å‚¨ä¸å˜é•¿è®°å½•ç®¡ç†
- ç¼“å†²æ± ç®¡ç†ä¸ LRU é¡µé¢æ›¿æ¢
- Write-Ahead Logging ä¸ ARIES å´©æºƒæ¢å¤
- MVCC + é”ç®¡ç†
- ç«å±±æ¨¡å‹æŸ¥è¯¢æ‰§è¡Œ
- æŸ¥è¯¢ä¼˜åŒ–ï¼ˆè°“è¯ä¸‹æ¨ã€è¿æ¥é¡ºåºé€‰æ‹©ç­‰ï¼‰

å…¶å†…éƒ¨ç»“æ„ä¸å·¥ä¸šçº§æ•°æ®åº“ï¼ˆå¦‚ PostgreSQLï¼‰ç›¸ä¼¼ï¼Œä½†è§„æ¨¡æ›´é€‚åˆæ•™å­¦ã€‚

------

# ğŸ— æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           SQL Frontend      â”‚
â”‚   (Parser + Binder + Planner) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  Query Optimizer  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚   Executor    â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
              â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚     Transaction Manager       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚     Log Manager / ARIES       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚     Buffer Pool + LRU Cache   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚         Storage Layer         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

------

# ğŸ“ å®éªŒå†…å®¹ç®€ä»‹ï¼ˆLab0â€“Lab5ï¼‰

ä»¥ä¸‹ä¸ºå„å®éªŒå†…å®¹ç®€è¿°ï¼Œå®Œæ•´è¦æ±‚è¯·è§å®éªŒæ–‡æ¡£ã€‚

------

## âœ” **Lab0 â€“ ç¯å¢ƒé…ç½®ä¸åŸºç¡€ SQL æ”¯æŒ**

- åŸºç¡€ SQL è§£æ
- ç®€å•è¡¨è¾¾å¼æ±‚å€¼
- å˜é‡ set/show
- é€šè¿‡ `make lab0` è‡ªåŠ¨æµ‹è¯•

------

## âœ” **Lab1 â€“ å˜é•¿è®°å½•ä¸é¡µå¼å­˜å‚¨ç®¡ç†**

å®ç°è¡¨ä¸æ•°æ®é¡µçš„åº•å±‚åŠŸèƒ½ï¼š

- TablePage çš„ Slot Directory
- å˜é•¿è®°å½•æ’å…¥ä¸åˆ é™¤
- è®°å½•ç›®å½•ä¸ç©ºé—²ç©ºé—´ç®¡ç†
- æ‰©å±•ï¼šæ›´æ™ºèƒ½çš„ç©ºé—´å¤ç”¨ç­–ç•¥

------

## âœ” **Lab2 â€“ æ—¥å¿—ä¸æ•…éšœæ¢å¤ï¼ˆARIESï¼‰**

- å†™å‰æ—¥å¿—ï¼ˆWALï¼‰
- ARIES ä¸‰é˜¶æ®µï¼š
  - Analysis
  - Redo
  - Undo
- Insert / Delete / NewPage ç­‰æ—¥å¿—æ ¼å¼
- äº‹åŠ¡ rollback
- ç³»ç»Ÿå´©æºƒåçš„ recover

------

## âœ” **Lab3 â€“ MVCC + ä¸¤é˜¶æ®µé”ï¼ˆ2PLï¼‰**

- xmin/xmax/cid å¤šç‰ˆæœ¬é“¾
- å¯è§æ€§åˆ¤æ–­
- RC / RR / Serializable ä¸€è‡´æ€§çº§åˆ«
- å¼ºä¸¤é˜¶æ®µé”ï¼ˆSS2PLï¼‰
- Select for Update
- æ‰©å±•ï¼š
  - æ­»é”æ£€æµ‹
  - ç‰ˆæœ¬åƒåœ¾å›æ”¶

------

## âœ” **Lab4 â€“ æŸ¥è¯¢æ‰§è¡Œï¼ˆç«å±±æ¨¡å‹ï¼‰**

è¡¥å…¨å¤šç§æ‰§è¡Œå™¨ï¼š

- SeqScan
- Filter
- Projection
- OrderByï¼ˆå†…å­˜æ’åºï¼‰
- Limit
- Nested Loop Join
- Merge Join

æ‰©å±•ï¼š

- å¤–å­˜æ’åº
- Hash Join
- èšåˆç®—å­ï¼ˆAggregateï¼‰

------

## âœ” **Lab5 â€“ æŸ¥è¯¢ä¼˜åŒ–ï¼ˆQuery Optimizationï¼‰**

å†…å®¹åŒ…æ‹¬ï¼š

### 1) æŸ¥è¯¢é‡å†™ï¼ˆQuery Rewriteï¼‰

- è°“è¯åˆ†è§£ï¼ˆSplitPredicatesï¼‰
- é€‰æ‹©ç®—å­ä¸‹æ¨ï¼ˆPushDownFilterï¼‰
- ä¸‹æ¨åˆ° SeqScanï¼ˆPushDownSeqScanï¼‰
- ç¬›å¡å°”ç§¯è½¬è¿æ¥ï¼ˆPushDownJoinï¼‰

### 2) è¿æ¥é¡ºåºé€‰æ‹©ï¼ˆJoin Order Selectionï¼‰

- åŸºäºè´ªå¿ƒç®—æ³•çš„ Join é‡æ’åº

æ‰©å±•å†…å®¹ï¼ˆè¯¾ç¨‹å¯é€‰ï¼‰ï¼š

- æŠ•å½±ä¸‹æ¨
- åŠ¨æ€è§„åˆ’ Join Orderï¼ˆSelinger DPï¼‰
- åŸºäºæ•°æ®ç”»åƒçš„åŸºæ•°ä¼°è®¡ï¼ˆHyperLogLog / Count-Minï¼‰

------

# ğŸ›  ç¯å¢ƒè¦æ±‚ï¼ˆè¡¥å…… & æ‰©å±•ï¼‰

### âœ” **æ“ä½œç³»ç»Ÿ**

HuaDB æ¨èåœ¨ç±» Unix ç¯å¢ƒä¸‹è¿è¡Œï¼š

- Ubuntu / Debian / Arch / CentOSï¼ˆæ¨è Ubuntu â‰¥ 20.04ï¼‰
- macOS
- Windows éœ€é€šè¿‡ WSL2 æˆ– Linux è™šæ‹Ÿæœº

------

### âœ” **ç³»ç»Ÿä¾èµ–**

è¯·ç¡®ä¿å®‰è£…ä»¥ä¸‹å·¥å…·ï¼š

| å·¥å…·              | ç”¨é€”         | å®‰è£…ï¼ˆUbuntuï¼‰         |
| ----------------- | ------------ | ---------------------- |
| `git`             | å…‹éš†ä»“åº“     | sudo apt install git   |
| `g++` / `clang++` | C++17 ç¼–è¯‘å™¨ | sudo apt install g++   |
| `cmake` â‰¥ 3.10    | æ„å»ºç³»ç»Ÿ     | sudo apt install cmake |
| `make`            | æ„å»ºè‡ªåŠ¨åŒ–   | sudo apt install make  |
| `gdb` / `lldb`    | è°ƒè¯•å™¨       | sudo apt install gdb   |

------

### âœ” **ç¼–è¯‘å™¨è¦æ±‚**

- å¿…é¡»æ”¯æŒ **C++17 æ ‡å‡†**
- æ¨èç‰ˆæœ¬ï¼š
  - g++ â‰¥ 9.0
  - clang++ â‰¥ 10.0

------

### âœ” **å†…å­˜ä¸æ€§èƒ½å»ºè®®**

HuaDB éå¸¸è½»é‡ï¼Œä¸€èˆ¬é…ç½®å³å¯ï¼š

- å†…å­˜ â‰¥ 1 GB
- 4 æ ¸ CPU
- 1 GB å¯ç”¨ç¡¬ç›˜ç©ºé—´

å¿…è¦æ—¶ä¹Ÿå¯è¿è¡Œåœ¨äº‘æœåŠ¡å™¨æˆ– GitHub Codespacesã€‚

------

### âœ” **å¯é€‰å·¥å…·**

ä¸ºäº†æ›´é«˜æ•ˆè°ƒè¯•å’Œå¼€å‘ï¼Œæ¨èï¼š

- VSCode + C++ æ’ä»¶
- CLionï¼ˆå¯ç›´æ¥è°ƒè¯• CMake é¡¹ç›®ï¼‰
- valgrindï¼ˆæ£€æŸ¥å†…å­˜æ³„æ¼ï¼‰

------

# ğŸ“¦ é¡¹ç›®æ„å»º

ä»ä»“åº“æ ¹ç›®å½•æ‰§è¡Œï¼š

```
CMAKE_BUILD_PARALLEL_LEVEL=$(nproc) make
```

ç¼–è¯‘åçš„å¯æ‰§è¡Œç¨‹åºä½äºï¼š

```
build/debug/bin/
```

------

# ğŸ’» è¿è¡Œæ•°æ®åº“ Shell

```
make shell
```

ç¤ºä¾‹ï¼š

```
huadb> CREATE TABLE test(id INT, info VARCHAR(10));
huadb> INSERT INTO test VALUES (1, 'abc');
huadb> SELECT * FROM test;
```

------

# ğŸ§ª è¿è¡Œæµ‹è¯•ç”¨ä¾‹

è¿è¡Œå…¨éƒ¨å®éªŒï¼š

```
make lab0
make lab1
make lab2
make lab3
make lab4
make lab5
```

ä»…è¿è¡ŒæŸä¸ªå®éªŒï¼š

```
./build/debug/bin/sqllogictest test/lab3
```

------

# ğŸ“ ä»£ç ç›®å½•ç»“æ„è¯´æ˜

```
huadb/
â”œâ”€â”€ binder/        -- è¯­ä¹‰è§£æ
â”œâ”€â”€ catalog/       -- ç³»ç»Ÿè¡¨
â”œâ”€â”€ common/        -- å…¬å…±å·¥å…·
â”œâ”€â”€ database/      -- DBEngine
â”œâ”€â”€ executors/     -- æŸ¥è¯¢æ‰§è¡Œå™¨
â”œâ”€â”€ log/           -- æ—¥å¿—ä¸æ¢å¤
â”œâ”€â”€ operators/     -- è®¡åˆ’æ ‘èŠ‚ç‚¹ç»“æ„
â”œâ”€â”€ optimizer/     -- æŸ¥è¯¢ä¼˜åŒ–å™¨
â”œâ”€â”€ planner/       -- æŸ¥è¯¢è®¡åˆ’ç”Ÿæˆå™¨
â”œâ”€â”€ storage/       -- é¡µå¼å­˜å‚¨
â”œâ”€â”€ table/         -- è¡¨ä¸è¡¨é¡µ
â”œâ”€â”€ transaction/   -- MVCC ä¸é”
â””â”€â”€ test/          -- æµ‹ä¾‹
```

------

# â“ å¸¸è§é—®é¢˜ FAQ

### 1. Windows èƒ½ç›´æ¥è¿è¡Œå—ï¼Ÿ

ä¸èƒ½ã€‚è¯·ä½¿ç”¨ï¼š

- WSL2ï¼ˆæ¨èï¼‰
- Ubuntu è™šæ‹Ÿæœº

------

### 2. sqllogictest æŠ¥è·¯å¾„é”™è¯¯ï¼Ÿ

è¯·åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œï¼š

```
./build/debug/bin/sqllogictest test/lab2
```

------

### 3. gdb æ–­ç‚¹æ— æ³•å‘½ä¸­ï¼Ÿ

è¯·ç¡®è®¤ä½¿ç”¨ debug ç‰ˆæœ¬ï¼š

```
build/debug/bin/shell
```

------

### 4. make æŠ¥é”™ï¼Ÿ

æ£€æŸ¥ï¼š

- æ˜¯å¦å®‰è£… C++17 ç¼–è¯‘å™¨
- cmake ç‰ˆæœ¬ â‰¥ 3.10
- åŒ…å«è·¯å¾„æœªä¿®æ”¹

------

# ğŸ“ License

æœ¬é¡¹ç›®ç”¨äºé«˜æ ¡æ•°æ®åº“è¯¾ç¨‹æ•™å­¦ï¼Œä¸å»ºè®®ç”¨äºç”Ÿäº§ç¯å¢ƒä½¿ç”¨ã€‚